{
  "name": "Interruption Test Scenarios",
  "description": "Collection of scenarios for testing interruption and timing behavior",
  "scenarios": [
    {
      "name": "Quit During Active Processing",
      "description": "Tests quit command while LLM processing is active",
      "setup": {
        "mockResponses": [
          {
            "endpoint": "/v1/chat/completions",
            "response": {
              "type": "fixed",
              "content": "This response was interrupted during processing.",
              "delayMs": 5000
            }
          }
        ]
      },
      "steps": [
        {
          "type": "input",
          "action": "Start long processing task",
          "timeout": 5000
        },
        {
          "type": "wait",
          "action": "llm_request",
          "timeout": 3000
        },
        {
          "type": "command",
          "action": "/quit",
          "timeout": 2000
        }
      ],
      "assertions": [
        {
          "type": "process",
          "target": "application",
          "condition": "running",
          "expected": false
        },
        {
          "type": "process",
          "target": "mock_server",
          "condition": "mock_requests",
          "expected": 1
        }
      ],
      "cleanup": {
        "killProcesses": true,
        "restoreEnvironment": true
      }
    },
    {
      "name": "Streaming Interruption",
      "description": "Tests interruption of streaming responses",
      "setup": {
        "mockResponses": [
          {
            "endpoint": "/v1/chat/completions",
            "response": {
              "type": "streaming",
              "content": [
                "This is ",
                "a streaming ",
                "response that ",
                "will be ",
                "interrupted ",
                "before completion."
              ],
              "delayMs": 500
            }
          }
        ]
      },
      "steps": [
        {
          "type": "input",
          "action": "Start streaming response",
          "timeout": 5000
        },
        {
          "type": "wait",
          "action": "llm_request",
          "timeout": 3000
        },
        {
          "type": "wait",
          "action": "ui:This is a streaming",
          "timeout": 5000
        },
        {
          "type": "command",
          "action": "/quit",
          "timeout": 2000
        }
      ],
      "assertions": [
        {
          "type": "process",
          "target": "application",
          "condition": "running",
          "expected": false
        },
        {
          "type": "ui",
          "target": "output",
          "condition": "contains",
          "expected": "This is a streaming"
        }
      ],
      "cleanup": {
        "killProcesses": true,
        "restoreEnvironment": true
      }
    }
  ]
}